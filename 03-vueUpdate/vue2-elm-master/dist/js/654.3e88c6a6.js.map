{"version":3,"file":"js/654.3e88c6a6.js","mappings":"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","sources":["webpack://elm/./src/page/search/search.vue","webpack://elm/./src/page/search/search.vue?8dfc"],"sourcesContent":["<template>\n  \t<div class=\"paddingTop search_page\">\n        <head-top head-title=\"搜索\" goBack=\"true\"></head-top>\n        <form class=\"search_form\">\n            <input type=\"search\" name=\"search\" placeholder=\"请输入商家或美食名称\" class=\"search_input\" v-model=\"searchValue\" @input=\"checkInput\">\n            <input type=\"submit\" name=\"submit\" class=\"search_submit\" @click.prevent=\"searchTarget('')\">\n        </form>\n        <section v-if=\"restaurantList.length\">\n            <h4 class=\"title_restaurant\">商家</h4>\n            <ul class=\"list_container\">\n                <router-link :to=\"{path:'/shop', query:{id:item.id}}\" tag=\"li\" v-for=\"item in restaurantList\" :key=\"item.id\" class=\"list_li\">\n                    <section class=\"item_left\">\n                        <img :src=\"imgBaseUrl + item.image_path\" class=\"restaurant_img\">\n                    </section>\n                    <section class=\"item_right\">\n                        <div class=\"item_right_text\">\n                            <p>\n                                <span>{{item.name}}</span>\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"24\" height=\"14\" class=\"pay_icon\">\n                                    <polygon points=\"0,14 4,0 24,0 20,14\" style=\"fill:none;stroke:#FF6000;stroke-width:1\" />\n                                    <line x1=\"1.5\" y1=\"12\" x2=\"20\" y2=\"12\" style=\"stroke:#FF6000;stroke-width:1.5\"/>\n                                    <text x=\"3.5\" y=\"9\" style=\"fill:#FF6000;font-size:9;font-weight:bold;\">支付</text>\n                                </svg>\n                            </p>\n                            <p>月售 {{item.month_sales||item.recent_order_num}} 单</p>\n                            <p>{{item.delivery_fee||item.float_minimum_order_amount}} 元起送 / 距离{{item.distance}}</p>\n                        </div>\n                        <ul class=\"item_right_detail\">\n                            <li v-for=\"activities in item.restaurant_activity\" :key=\"activities.id\">\n                                <span :style=\"{backgroundColor: '#' + activities.icon_color}\" class=\"activities_icon\">{{activities.icon_name}}</span>\n                                <span>{{activities.name}}</span>\n                                <span class=\"only_phone\">(手机客户端专享)</span>\n                            </li>\n                        </ul>\n                    </section>\n                </router-link>\n            </ul>\n        </section>\n        <section class=\"search_history\" v-if=\"searchHistory.length&&showHistory\">\n            <h4 class=\"title_restaurant\">搜索历史</h4>\n            <ul>\n                <li v-for=\"(item, index) in searchHistory\" :key=\"index\" class=\"history_list\">\n                    <span class=\"history_text ellipsis\" @click=\"searchTarget(item)\">{{item}}</span>\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" class=\"delete_icon\" @click=\"deleteHistory(index)\">\n                        <line x1=\"8\" y1=\"8\" x2=\"18\" y2=\"18\" style=\"stroke:#999;stroke-width:3\" />\n                        <line x1=\"18\" y1=\"8\" x2=\"8\" y2=\"18\" style=\"stroke:#999;stroke-width:3\" />\n                    </svg>\n                </li>\n            </ul>\n            <footer class=\"clear_history\" @click=\"clearAllHistory\">清空搜索历史</footer>\n        </section>\n        <div class=\"search_none\" v-if=\"emptyResult\">很抱歉！无搜索结果</div>\n        <foot-guide></foot-guide>\n    </div>\n</template>\n\n<script>\nimport headTop from '../../components/header/head'\nimport footGuide from '../../components/footer/footGuide'\nimport {searchRestaurant} from '../../service/getData'\nimport {imgBaseUrl} from '../../config/env'\nimport {getStore, setStore} from '../../config/mUtils'\n\nexport default {\n\tdata(){\n        return {\n            geohash: '', // msite页面传递过来的地址信息\n            searchValue: '', // 搜索内容\n            restaurantList: [], // 搜索返回的结果\n            imgBaseUrl, // 图片域名地址\n            searchHistory: [], // 搜索历史记录\n            showHistory: true, // 是否显示历史记录，只有在返回搜索结果后隐藏\n            emptyResult: false, // 搜索结果为空时显示\n        }\n    },\n    created(){\n       \n    },\n    mounted(){\n        this.geohash = this.$route.params.geohash;\n        //获取搜索历史记录\n        if (getStore('searchHistory')) {\n            this.searchHistory = JSON.parse(getStore('searchHistory'));\n        }\n    },\n    components:{\n        headTop,\n        footGuide,\n    },\n    methods:{\n        //点击提交按钮，搜索结果并显示，同时将搜索内容存入历史记录\n        async searchTarget(historyValue){\n            if (historyValue) {\n                this.searchValue = historyValue;\n            }else if (!this.searchValue) {\n                return \n            }\n            //隐藏历史记录\n            this.showHistory = false;\n            //获取搜索结果\n            this.restaurantList = await searchRestaurant(this.geohash, this.searchValue);\n            this.emptyResult = !this.restaurantList.length;\n            /**\n             * 点击搜索结果进入下一页面时进行判断是否已经有一样的历史记录\n             * 如果没有则新增，如果有则不做重复储存，判断完成后进入下一页\n             */\n            let history = getStore('searchHistory');\n            if (history) { \n                let checkrepeat = false;\n                this.searchHistory = JSON.parse(history);\n                this.searchHistory.forEach(item => {\n                    if (item == this.searchValue) {\n                        checkrepeat = true;\n                    }\n                })\n                if (!checkrepeat) {\n                    this.searchHistory.push(this.searchValue)\n                }\n            }else {\n                this.searchHistory.push(this.searchValue)\n            }\n            setStore('searchHistory',this.searchHistory)\n        },\n        //搜索结束后，删除搜索内容直到为空时清空搜索结果，并显示历史记录\n        checkInput(){\n            if (this.searchValue === '') {\n                this.showHistory = true; //显示历史记录\n                this.restaurantList = []; //清空搜索结果\n                this.emptyResult = false; //隐藏搜索为空提示\n            } \n        },\n        //点击删除按钮，删除当前历史记录\n        deleteHistory(index){\n            this.searchHistory.splice(index, 1);\n            setStore('searchHistory',this.searchHistory);\n        },\n        //清除所有历史记录\n        clearAllHistory(){\n            this.searchHistory = [];\n            setStore('searchHistory',this.searchHistory);\n        }\n    }\n}\n\n</script>\n\n<style lang=\"scss\" scoped>\n    @import '../../style/mixin';\n    \n    .search_page{\n        margin-bottom: 2rem;\n    }\n    .search_form{\n        background-color: #fff;\n        padding: 0.5rem;\n        display: flex;\n        input{\n            height: 1.5rem;\n        }\n        .search_input{\n            flex: 4;\n            border: 0.025rem solid $bc;\n            @include sc(0.65rem, #333);\n            border-radius: 0.125rem;\n            background-color: #f2f2f2;\n            font-weight: bold;\n            padding: 0 0.25rem;\n        }\n        .search_submit{\n            flex: 1;\n            border: 0.025rem solid $blue;\n            margin-left: .2rem;\n            @include sc(0.65rem, #fff);\n            border-radius: 0.125rem;\n            background-color: $blue;\n            font-weight: bold;\n            padding: 0 0.25rem;\n        }\n    }\n    .title_restaurant{\n        font-size: 0.6rem;\n        line-height: 2rem;\n        text-indent: 0.5rem;\n        font-weight: bold;\n        color: #666;\n    }\n    .list_container{\n        background-color: #fff;\n    }\n    .list_li{\n        display: flex;\n        justify-content: 'center';\n        padding: 0.5rem;\n        border-bottom: 0.025rem solid $bc;\n        .item_left{\n            margin-right: 0.25rem;\n            .restaurant_img{\n                @include wh(1.7rem, 1.7rem);\n            }\n        }\n        .item_right{\n            font-size: 0.55rem;\n            flex: 1;\n            .item_right_text{\n                padding-bottom: 0.25rem;\n                border-bottom: 0.025rem solid $bc;\n                p{\n                    line-height: .9rem;\n                }\n                .pay_icon{\n                    margin-bottom: -0.08rem;\n                }\n            }\n            .item_right_detail{\n                margin-top: 0.25rem;\n                li{\n                    font-size: 0;\n                    span{\n                        font-size: .5rem;\n                        vertical-align: middle;\n                        display: inline-block;\n                        margin-bottom: 0.2rem;\n                    }\n                    .activities_icon{\n                        @include sc(.5rem, #fff);\n                        font-weight: bold;\n                        padding: .04rem;\n                        border-radius: 0.15rem;\n                        margin-right: 0.125rem;\n                    }\n                    .only_phone{\n                        color: #FF6000;\n                    }\n                }\n            }\n        }\n    }\n    .search_history{\n        .history_list{\n            background-color: #fff;\n            border-bottom: 0.025rem solid $bc;\n            @include font(0.7rem, 2rem);\n            padding: 0 0.3rem;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            .history_text{\n                display: inline-block;\n                width: 80%;\n            }\n            .delete_icon{\n                @include wh(1rem, 1rem);\n            }\n        }\n        .clear_history{\n            background-color: #fff;\n            color: $blue;\n            @include font(.7rem, 2rem);\n            font-weight: bold;\n            text-align: center;\n        }\n    }\n    .search_none{\n        margin: 0 auto;\n        @include font(0.65rem, 1.75rem);\n        color: #333;\n        background-color: #fff;\n        text-align: center;\n        margin-top: 0.125rem;\n    }\n</style>\n","import { render } from \"./search.vue?vue&type=template&id=28445d52&scoped=true\"\nimport script from \"./search.vue?vue&type=script&lang=js\"\nexport * from \"./search.vue?vue&type=script&lang=js\"\n\nimport \"./search.vue?vue&type=style&index=0&id=28445d52&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/@vue/cli-service/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-28445d52\"]])\n\nexport default __exports__"],"names":["class","xmlns","version","width","height","points","style","x1","y1","x2","y2","x","y","goBack","type","name","placeholder","checkInput","searchValue","searchTarget","restaurantList","item","to","id","tag","key","src","imgBaseUrl","image_path","month_sales","recent_order_num","delivery_fee","float_minimum_order_amount","distance","restaurant_activity","activities","icon_color","icon_name","searchHistory","length","showHistory","index","deleteHistory","clearAllHistory","data","geohash","emptyResult","created","mounted","this","$route","params","JSON","parse","components","headTop","footGuide","methods","historyValue","history","checkrepeat","forEach","push","splice","__exports__","render"],"sourceRoot":""}